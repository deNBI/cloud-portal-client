name: auto-format
on: pull_request
jobs:
    format:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - name: Checkout Branch
              run: date +%s > report.txt
            - name: black
              uses: lgeiger/black-action@master
              with:
                  args: .
            - name: Check for modified files
              id: git-check
              run: echo ::set-output name=modified::$(if git diff-index --quiet HEAD --; then echo "false"; else echo "true"; fi)
            - name: Create Pull Request
              if: steps.git-check.outputs.modified == 'true'
              id: cpr
              uses: peter-evans/create-pull-request@v2
              with:
               token: ${{ secrets.GITHUB_TOKEN }}
               commit-message: fix(Linting):blacked code
               title: Automated Blacked Linting
               body: |
                        New report
                        - Contains *today's* date
                        - Auto-generated by [create-pull-request][1]

                        [1]: https://github.com/peter-evans/create-pull-request
               labels: automated,linting
               reviewers: dweinholz,ekatchko,vktrrdk
               branch: fix(linting)_${{github.ref}}
            - name: Check outputs
              run: |
                      echo "Pull Request Number - ${{ env.PULL_REQUEST_NUMBER }}"
                      echo "Pull Request Number - ${{ steps.cpr.outputs.pr_number }}"
